import ast

from api_chatGPT import GPTResponse
from excel_adm_test import extract_data_excel
from pdf_adm_mack_test import extract_data_pdf
import pandas as pd

pd.set_option('display.max_rows', None)
pd.set_option('display.max_columns', None)


def main():
    pdf = extract_data_pdf("adm_mack_test.pdf")
    excel = extract_data_excel("adm_test.xlsm")
    texto = '''
COMPONENTES Nº DE AULAS CARGA Código Nome HORÁRIA ANO/SEMESTRE NOTA FINAL RESULTADO PROFESSOR(A) TITULACAO 01 ETAPA ENEC51403 CIENC,TECNOL E SOC NA ADM E NEG 2 31h 40min 2019/ 1 6,00 APROVADO ARNALDO FRANCISCO CARDOSO MESTRE ENEX50523 INFORMATICA BAS PARA ADMINISTRADORES 2 31h 40min 2019/ 1 8,40 APROVADO NELSON MITSUO SHIMABUKURO MESTRE ENEX50650 MARKETING I 4 63h 20min 2019/ 1 7,50 APROVADO FATIMA GUARDANI ROMITO DOUTOR ENEC50280 ELEMENTOS DE MATEMATICA 4 63h 20min 2020/ 1 7,50 APROVADO MAURICIO TAKAHASHI MESTRE ENEX50014 AMBIENTE PROF DO ADMINISTRADOR 4 63h 20min 2019/ 1 7,50 APROVADO ANA MARIA DOS SANTOS DOUTOR ENEC50151 COMUNICACAO E EXPRESSAO 2 31h 40min 2019/ 1 7,90 APROVADO LUCAS FERNANDO RIBEIRO JUKNEVI MESTRE ENUN51118 ETICA E CIDADANIA 2 31h 40min 2019/ 1 8,80 APROVADO JOSE ANTONIO DE GOES FILHO MESTRE 02 ETAPA ENEC50451 FUNDAMENTOS DE MATEMATICA 4 63h 20min 2021/ 1 7,00 APROVADO ANGELA DE SOUZA MENEZES MESTRE ENEC50733 NOCOES DE DIREITO 2 31h 40min 2019/ 2 8,00 APROVADO PAULA ZAMBELLI SALGADO BRASIL DOUTOR

ENEC51090 TEORIAS DA ADMINISTRACAO 4 63h 20min 2019/ 2 7,60 APROVADO MARIA THEREZA RUBIM CAMARGO SO MESTRE ENEC50549 INTRODUCAO AS CIENCIAS SOCIAIS 4 63h 20min 2019/ 2 6,10 APROVADO ARNALDO FRANCISCO CARDOSO MESTRE ENEC50708 MICROECONOMIA APLICADA AOS NEGOCIOS 4 63h 20min 2019/ 2 6,10 APROVADO ANAOR DONIZETTI CARNEIRO DA SI DOUTOR ENUN51119 INTRODUCAO A COSMOVISAO REFORMADA 2 31h 40min 2019/ 2 8,30 APROVADO ANA MARIA BRITO SANCHES DOUTOR 03 ETAPA ENEC50631 MACROECON E ECON CONTEMPORANEA 4 63h 20min 2020/ 1 6,30 APROVADO ARNALDO FRANCISCO CARDOSO MESTRE ENEC50543 INTRODUCAO A ESTATISTICA 4 63h 20min 2020/ 2 6,90 APROVADO ANGELA DE SOUZA MENEZES MESTRE ENEC50654 MATEMATICA FINANCEIRA 4 63h 20min 2020/ 2 6,00 APROVADO ANAOR DONIZETTI CARNEIRO DA SI DOUTOR ENEX50232 DIREITO APLICADO A ADMINISTRACAO 2 31h 40min 2020/ 1 7,50 APROVADO TAIS MALLMANN RAMOS DOUTOR ENEC51041 SOCIOLOGIA DAS ORGANIZACOES 2 31h 40min 2020/ 1 7,50 APROVADO IRANDY MARCOS DA CRUZ MESTRE ENEC50176 CONTABILIDADE E ANALISE DE BALANCOS 4 63h 20min 2021/ 2 7,50 APROVADO JOSE RAIMUNDO DE LIMA MESTRE 04 ETAPA ENEX50872 PROCESSOS ORGANIZACIONAIS 2 31h 40min 2020/ 2 6,00 APROVADO ARNALDO TURUO ONO DOUTOR ENEC50002 ADM ESTRATEGICA E SUSTENTABILIDADE 4 63h 20min 2022/ 1 8,00 APROVADO ROBERTO LUCIO FERREIRA MESTRE ENEC50674 MET QUANTITATIVOS EM PROC DECISORIOS 4 63h 20min 2021/ 1 6,10 APROVADO MAURICIO TAKAHASHI MESTRE ENEX50651 MARKETING II 4 63h 20min 2022/ 1 6,60 APROVADO ELCIO ALVES FERREIRA DOUTOR ENUN51120 PRINCIPIOS DE EMPREENDEDORISMO 2 31h 40min 2021/ 2 6,00 APROVADO ARNALDO FRANCISCO CARDOSO MESTRE ENEC50170 CONTABILIDADE DE CUSTOS 4 63h 20min 2022/ 1 1,70 REPROVADO JOSE RAIMUNDO DE LIMA MESTRE 05 ETAPA ENEX50550 INVESTIMENTOS 4 63h 20min / ENEC50808 PESQUISA OPERACIONAL I 2 31h 40min 2022/ 1 8,90 APROVADO ARNALDO TURUO ONO DOUTOR ENEC50145 COMPORTAMENTO ORGANIZACIONAL 4 63h 20min 2022/ 1 9,80 APROVADO NELSON MITSUO SHIMABUKURO MESTRE ENEX50475 GESTAO DE OPERACOES 4 63h 20min / ENEX50812 PLANEJ DE MARKETING CORPORATIVO 4 63h 20min / ENUN51121 PROJETOS EMPREENDEDORES 2 31h 40min / 06 ETAPA ENEC50482 GESTAO FINANCEIRA 2 31h 40min / ENEX50629 LOGISTICA EMPRESARIAL 4 63h 20min /

ENEC50678 METOD DE PESQ EM CIENC SOC APLICADAS 4 63h 20min / ENEC50828 POL E PRAT DE GESTAO DE PESSOAS 4 63h 20min / ENEC50472 GESTAO DA INOVACAO 2 31h 40min / ENEC51020 SIST DE INFORMACAO APLIC A GESTAO 2 31h 40min / ENEC50018 ANALISE DE VIABILIDADE FINANCEIRA 2 31h 40min / 07 ETAPA ENEC50476 GESTAO DE PROJETOS 4 63h 20min / ENEX50469 GEST ESTRATEG PARA A SUSTENTABILIDADE 4 63h 20min / ORTC51122 TRAB CONCL CURSO I-ADM 4 63h 20min / ENOP51337 CRIACAO DE NEGOCIOS INOVADORES 4 63h 20min / 08 ETAPA ENEX50483 GESTAO INTEGRADA DE EMPRESAS 4 63h 20min / ENOP50773 OPTATIVA II 4 63h 20min / ENOP50779 OPTATIVA III 4 63h 20min / ORES51208 ESTAGIO-ADM 4 63h 20min / ORTC51123 TRAB CONCL CURSO II-ADM 4 63h 20min / ENOP51336 AVALIACAO DE EMPRESAS 4 63h 20min /
    '''

    # response = GPTResponse("Separe por código de matéria/nome da matéria/número de aulas/carga horária/ano e semestre/nota final/resultado, excluindo registros de professor(a)/ titulacao, preenchendo com - informações não encontradas. Mande o resultado como uma lista de listas (cada registro sendo uma lista). Deve conter os 48 registros: " + texto)
    response = GPTResponse("Separate by codigo da materia/nome da materia/numero de aulas/carga horaria/ano e semestre/notal final/resultado, excluding professor(a)/titulacao records, filling in with - information not found. Send the result as a list of lists (each record being a list). It must contain the 48 records: " + texto)
    response_list = pd.DataFrame(list(response))
    pd.DataFrame(list(response))

    print(response)



# if __name__ == "__main__":
#     main()

list_string = '''
[['ENEK51403', 'CIENC,TECNOL E SOC NA ADM E NEG', '2', '31h 40min', '2019/ 1', '6,00', 'APROVADO', 'ARNALDO FRANCISCO CARDOSO', 'MESTRE'],
['ENEX50523', 'INFORMATICA BAS PARA ADMINISTRADORES', '2', '31h 40min', '2019/ 1', '8,40', 'APROVADO', 'NELSON MITSUO SHIMABUKURO', 'MESTRE'],
['ENEX50650', 'MARKETING I', '4', '63h 20min', '2019/ 1', '7,50', 'APROVADO', 'FATIMA GUARDANI ROMITO', 'DOUTOR'],
['ENEK50280','ELEMENTOS DE MATEMATICA','4','63h 20min','2020/ 1','7,50','APROVADO','MAURICIO TAKAHASHI','MESTRE'],
['ENEX50014','AMBIENTE PROF DO ADMINISTRADOR','4','63h 20min','2019/ 1','7,50','APROVADO','ANA MARIA DOS SANTOS','DOUTOR'],
['ENEK50151','COMUNICACAO E EXPRESSAO','2','31h 40min','2019/ 1','7,90','APROVADO','LUCAS FERNANDO RIBEIRO JUKNEVI','MESTRE'],
['ENUN51118','ETICA E CIDADANIA','2','31h 40min','2019/ 1','8,80','APROVADO','JOSE ANTONIO DE GOES FILHO','MESTRE'],
['ENEK50451','FUNDAMENTOS DE MATEMATICA','4','63h 20min','2021/ 1','7,00','APROVADO','ANGELA DE SOUZA MENEZES','MESTRE'],
['ENEK50733','NOCOES DE DIREITO','2','31h 40min','2019/ 2','8,00','APROVADO','PAULA ZAMBELLI SALGADO BRASIL','DOUTOR'],
['ENEX51090','TEORIAS DA ADMINISTRACAO','4','63h 20min','2019/ 2','7,60','APROVADO','MARIA THEREZA RUBIM CAMARGO SO','MESTRE'],
['ENEK50549','INTRODUCAO AS CIENCIAS SOCIAIS','4','63h 20min','2019/ 2','6,10','APROVADO','ARNALDO FRANCISCO CARDOSO','MESTRE'],
['ENEK50708','MICROECONOMIA APLICADA AOS NEGOCIOS','4','63h 20min','2019/ 2','6,10','APROVADO','ANAOR DONIZETTI CARNEIRO DA SI','DOUTOR'],
['ENUN51119','INTRODUCAO A COSMOVISAO REFORMADA','2','31h 40min','2019/ 2','8,30','APROVADO','ANA MARIA BRITO SANCHES','DOUTOR'],
['ENEK50631','MACROECON E ECON CONTEMPORANEA','4','63h 20min','2020/ 1','6,30','APROVADO','ARNALDO FRANCISCO CARDOSO','MESTRE'],
['ENEK50543','INTRODUCAO A ESTATISTICA','4','63h 20min','2020/ 2','6,90','APROVADO','ANGELA DE SOUZA MENEZES','MESTRE'],
['ENEK50654','MATEMATICA FINANCEIRA','4','63h 20min','2020/ 2','6,00','APROVADO','ANAOR DONIZETTI CARNEIRO DA SI','DOUTOR'],
['ENEX50232','DIREITO APLICADO A ADMINISTRACAO','2','31h 40min','2020/ 1','7,50','APROVADO','TAIS MALLMANN RAMOS','DOUTOR'],
['ENEK51041','SOCIOLOGIA DAS ORGANIZACOES','2','31h 40min','2020/ 1','7,50','APROVADO','IRANDY MARCOS DA CRUZ','MESTRE'],
['ENEK50176','CONTABILIDADE E ANALISE DE BALANCOS','4','63h 20min','2021/ 2','7,50','APROVADO','JOSE RAIMUNDO DE LIMA','MESTRE'],
['ENEX50872','PROCESSOS ORGANIZACIONAIS','2','31h 40min','2020/ 2','6,00','APROVADO','ARNALDO TURUO ONO','DOUTOR'],
['ENEK50002','ADM ESTRATEGICA E SUSTENTABILIDADE','4','63h 20min','2022/ 1','8,00','APROVADO','ROBERTO LUCIO FERREIRA','MESTRE'],
['ENEK50674','MET QUANTITATIVOS EM PROC DECISORIOS','4','63h 20min','2021/ 1','6,10','APROVADO','MAURICIO TAKAHASHI','MESTRE'],
['ENEX50651','MARKETING II','4','63h 20min','2022/ 1','6,60','APROVADO','ELCIO ALVES FERREIRA','DOUTOR'],
['ENUN51120','PRINCIPIOS DE EMPREENDEDORISMO','2','31h 40min','2021/ 2','6,00','APROVADO','ARNALDO FRANCISCO CARDOSO','MESTRE'],
['ENEK50170','CONTABILIDADE DE CUSTOS','4','63h 20min','2022/ 1','1,70','REPROVADO','JOSE RAIMUNDO DE LIMA','MESTRE'],
['ENEX50550','INVESTIMENTOS','4','63h 20min','-','-','-', '-', '-'],
['ENEK50808','PESQUISA OPERACIONAL I','2','31h 40min','2022/ 1','8,90','APROVADO','ARNALDO TURUO ONO','DOUTOR'],
['ENEK50145','COMPORTAMENTO ORGANIZACIONAL','4','63h 20min','2022/ 1','9,80','APROVADO','NELSON MITSUO SHIMABUKURO','MESTRE'],
['ENEX50475','GESTAO DE OPERACOES','4','63h 20min','-','-','-', '-', '-'],
['ENEX50812','PLANEJ DE MARKETING CORPORATIVO','4','63h 20min','-','-','-', '-', '-'],
['ENUN51121','PROJETOS EMPREENDEDORES','2','31h 40min','-','-','-', '-', '-'],
['ENEK50482','GESTAO FINANCEIRA','2','31h 40min','-','-','-', '-', '-'],
['ENEX50629','LOGISTICA EMPRESARIAL','4','63h 20min','-','-','-', '-', '-'],
['ENEK50678','METOD DE PESQ EM CIENC SOC APLICADAS','4','63h 20min','-','-','-', '-', '-'],
['ENEK50828','POL E PRAT DE GESTAO DE PESSOAS','4','63h 20min','-','-','-', '-', '-'],
['ENEK50472','GESTAO DA INOVACAO','2','31h 40min','-','-','-', '-', '-'],
['ENEK51020','SIST DE INFORMACAO APLIC A GESTAO','2','31h 40min','-','-','-', '-', '-'],
['ENEK50018','ANALISE DE VIABILIDADE FINANCEIRA','2','31h 40min','-','-','-', '-', '-'],
['ENUK50476','GESTAO DE PROJETOS','4','63h 20min','-','-','-', '-', '-'],
['ENEX50469','GEST ESTRATEG PARA A SUSTENTABILIDADE','4','63h 20min','-','-','-', '-', '-'],
['ORTK51122','TRAB CONCL CURSO I-ADM','4','63h 20min','-','-','-', '-', '-'],
['ENOK51337','CRIACAO DE NEGOCIOS INOVADORES','4','63h 20min','-','-','-', '-', '-'],
['ENEX50483','GESTAO INTEGRADA DE EMPRESAS','4','63h 20min','-','-','-', '-', '-'],
['ENOK50773','OPTATIVA II','4','63h 20min','-','-','-', '-', '-'],
['ENOK50779','OPTATIVA III','4','63h 20min','-','-','-', '-', '-'],
['OREK51208','ESTAGIO-ADM','4','63h 20min','-','-','-', '-', '-'],
['ORTK51123','TRAB CONCL CURSO II-ADM','4','63h 20min','-','-','-', '-', '-'],
['ENOK51336','AVALIACAO DE EMPRESAS','4','63h 20min','-','-','-', '-', '-']]
'''

lista = ast.literal_eval(list_string)
print(lista)
dataframe_teste = pd.DataFrame(lista, columns=['codigo', 'materia', 'aulas', 'carga horaria', 'semestre', 'nota', 'resultado', 'professor', 'titulacao'])
print(dataframe_teste)